---
title: "The Bachelor/Bachelorette"
output: html_document
date: "2024-03-07"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown
```{r}
library(tidyverse)
library(janitor)
library(here)
```

Data of all 41 seasons of The BAchelor and The Bachelortte:
```{r}
season_details <- read.csv("data/season_details.csv")
```

1. Structure of this data set:
```{r}
glimpse(season_details)
```

2. New data set that only contains the seasons in which the couples are still together:
```{r}
still_together<- season_details%>%
  group_by(season, full_name, still_together)%>%
  filter(still_together=="TRUE")
```

3. How many couples, from all 41 seasons, are still together?
```{r}
Bachelor<- still_together%>%
  filter(show=="Bachelor")%>%
  count(still_together, show)
```

```{r}
Bachelor%>%
  ggplot(aes(x=season, y=full_name))+
  geom_col(fill = "darkred", alpha=0.8)+
  coord_flip()+
  labs(title="Couples Still Together by Season", x="Season", y="Couples")+
  theme(axis.text.x = element_text(angle = 60, hjust = 1),
        plot.title = element_text(size = 14, face="bold"))+
  geom_text(aes(label = season), vjust = -0.2, size = 3, color = "black")
```

```{r}
Bachelorette<- still_together%>%
  filter(show=="Bachelorette")%>%
  count(still_together, show)
```

```{r}
Bachelorette%>%
  ggplot(aes(x=season, y=full_name))+
  geom_col(fill = "darkred", alpha=0.8)+
  coord_flip()+
  labs(title="Couples Still Together by Season", x="Season", y="Couples")+
  theme(axis.text.x = element_text(angle = 60, hjust = 1),
        plot.title = element_text(size = 14, face="bold"))+
  geom_text(aes(label = season), vjust = -0.2, size = 3, color = "black")
```


4. Make a plot to show the number of couples still together by season. 
```{r}
ggplot(still_together, aes(x=season, y=full_name))+
  geom_col(fill = "darkred", alpha=0.8)+
  coord_flip()+
  labs(title="Couples Still Together by Season", x="Season", y="Couples")+
  theme(axis.text.x = element_text(angle = 60, hjust = 1),
        plot.title = element_text(size = 14, face="bold"))+
  geom_text(aes(label = season), vjust = -0.2, size = 3, color = "black")
```

5. Make a plot that shows all of the couples.
```{r}
ggplot(season_details, aes(x=season, y=full_name, fill=still_together))+
  geom_col()+
  coord_flip()+
  labs(title="Couple's Relationship Status by Season", x="Season", y="Name of Bachelor/Bachelorette")+
  theme(axis.text.x=element_text(angle=90, hjust = 1))
```

Data Set 2 which shows the hometowns of the last few contestants in each season:
```{r}
hometowns <- read.csv("data/hometown_coordinates.csv")
```

Data set 3 which shows the contestants that got eliminated throughout each season:
```{r}
eliminations <- read.csv("data/eliminations_and_dates.csv")
```

Data set 4 which shows the names of all the contestants in each season:
```{r}
contestants <- read.csv("data/contestant_details.csv")
```

6. How many contestants are in each season?
```{r}
contestants%>%
count(full_name, season)
```

7. Make a plot that shows the number of contestants in each season.
```{r}
contestants%>%
ggplot(aes(x=season))+
  geom_bar(fill = "darkred", alpha=0.8)+
  labs(title="Number of Contestants by Season", x="Season", y="Number of Contestants")+
  theme(axis.text.x = element_text(angle = 60, hjust = 1),
        plot.title = element_text(size = 14, face="bold"))+
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.2, size = 3, color = "black")
```

Data set 4 which shows more eliminations:
```{r}
compact_eliminations <- read.csv("data/eliminations_and_dates_compact.csv") 
```

8. Build an app that shows all of the couples that are still together:

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(here)
library(shiny)
library(shinydashboard)
library(lubridate)
```

App for the Bachelorette
```{r}
ui <- fluidPage(titlePanel("The Bachelor and The Bachelorette"),
                radioButtons("x", "Select Fill Variable", choices=c("Bachelor", "Bachelorette"), selected="Bachelor"),
                plotOutput("plot", width="600px", height="500px")
)

server <- function(input, output, session) {
  output$plot <- renderPlot({
  ggplot(Bachelor, aes(x=season, y=full_name))+
  geom_col(fill = "darkred", alpha=0.8)+
  coord_flip()+
  labs(title="Couples Still Together by Season", x="Season", y="Couples")+
  theme(axis.text.x = element_text(angle = 60, hjust = 1),
        plot.title = element_text(size = 14, face="bold"))+
  geom_text(aes(label = season), vjust = -0.2, size = 3, color = "black")
  })
  
  output$plot <- renderPlot({
  ggplot(Bachelorette, aes(x=season, y=full_name))+
  geom_col(fill = "darkred", alpha=0.8)+
  coord_flip()+
  labs(title="Couples Still Together by Season", x="Season", y="Couples")+
  theme(axis.text.x = element_text(angle = 60, hjust = 1),
        plot.title = element_text(size = 14, face="bold"))+
  geom_text(aes(label = season), vjust = -0.2, size = 3, color = "black")
})
}
shinyApp(ui, server)
```

App for the Bachelor
```{r}
ui <- fluidPage(titlePanel("The Bachelor and The Bachelorette"),
                radioButtons("x", "Select Fill Variable", choices=c("Bachelor", "Bachelorette"), selected="Bachelor"),
                plotOutput("plot", width="600px", height="500px")
)

server <- function(input, output, session) {
  output$plot <- renderPlot({
  ggplot(Bachelor, aes(x=season, y=full_name))+
  geom_col(fill = "darkred", alpha=0.8)+
  coord_flip()+
  labs(title="Couples Still Together by Season", x="Season", y="Couples")+
  theme(axis.text.x = element_text(angle = 60, hjust = 1),
        plot.title = element_text(size = 14, face="bold"))+
  geom_text(aes(label = season), vjust = -0.2, size = 3, color = "black")
  })
  
}

shinyApp(ui, server)
```


